
---

# Анализ результатов BLAST с использованием R

Данный проект представляет собой R-скрипт для фильтрации и преобразования результатов BLAST. Скрипт считывает входной файл с данными, фильтрует записи по заданным условиям, формирует информационные строки и преобразует данные в широкий формат, после чего сохраняет результат в формате TSV.

## Оглавление

- [Описание проекта](#описание-проекта)
- [Требования](#требования)
- [Установка](#установка)
- [Как использовать](#как-использовать)
- [Описание работы скрипта](#описание-работы-скрипта)
- [Контрибьюторы](#контрибьюторы)
- [Лицензия](#лицензия)

## Описание проекта

В этом проекте реализована обработка результатов BLAST, представленных в виде текстового файла. Основные возможности скрипта:

- Считывание входного файла (`input.txt`) с данными BLAST.
- Фильтрация строк по значению идентичности (более 85%) и e-value (равному 0).
- Формирование нового информационного столбца с данными о совпадениях.
- Преобразование данных из длинного формата в широкий с использованием функции `pivot_wider` из пакета **tidyr**.
- Сохранение итоговых данных в формате TSV (`out.tsv`).

## Требования

Для работы скрипта необходимо наличие:
- **R** (версия 3.6 или выше)
- Пакетов:
  - [dplyr](https://cran.r-project.org/package=dplyr)
  - [tidyr](https://cran.r-project.org/package=tidyr)

При необходимости установите их командой:

```r
install.packages("dplyr")
install.packages("tidyr")
```

## Установка

1. Склонируйте репозиторий:

   ```bash
   git clone git@github.com:KiselevSI/blast_data_transform.git
   ```

2. Откройте проект в RStudio или любом другом R-редакторе.
3. Установите необходимые зависимости (см. раздел **Требования**).

## Как использовать

1. Поместите входной файл с данными под названием `input.txt` в корневую папку репозитория.
2. Запустите скрипт (например, через RStudio):

   ```r
   source("script.R")
   ```

3. Результат работы скрипта будет сохранён в файле `out.tsv` в корневой папке проекта.

## Описание работы скрипта

Скрипт выполняет следующие шаги:

1. **Считывание данных:** Файл `input.txt` загружается в датафрейм.
2. **Назначение имён столбцам:** Определяются названия столбцов, соответствующие данным BLAST.
3. **Фильтрация данных:** Выбираются записи, у которых процент идентичности больше 85 и значение e-value равно 0.
4. **Создание информационного столбца:** Формируется новый столбец `info`, содержащий сведения о идентичности, длине совпадения, e-value и позициях в последовательностях.
5. **Преобразование формата данных:** С помощью функции `pivot_wider` данные разворачиваются в широкий формат, где строки идентифицируются по `subject`, а столбцы – по уникальным значениям `query`.
6. **Экспорт результатов:** Итоговый датафрейм записывается в файл `out.tsv` с использованием разделителя табуляции.

